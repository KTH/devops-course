<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>LCOV - trace.lcov_info_final - src/test.c</title>
  <link rel="stylesheet" type="text/css" href="../gcov.css">
</head>

<body>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="title">LCOV - code coverage report</td></tr>
    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>

    <tr>
      <td width="100%">
        <table cellpadding=1 border=0 width="100%">
          <tr>
            <td width="10%" class="headerItem">Current view:</td>
            <td width="35%" class="headerValue"><a href="../index.html">top level</a> - <a href="index.html">src</a> - test.c<span style="font-size: 80%;"> (source / <a href="test.c.func-sort-c.html">functions</a>)</span></td>
            <td width="5%"></td>
            <td width="15%"></td>
            <td width="10%" class="headerCovTableHead">Hit</td>
            <td width="10%" class="headerCovTableHead">Total</td>
            <td width="15%" class="headerCovTableHead">Coverage</td>
          </tr>
          <tr>
            <td class="headerItem">Test:</td>
            <td class="headerValue">trace.lcov_info_final</td>
            <td></td>
            <td class="headerItem">Lines:</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntry">296</td>
            <td class="headerCovTableEntryLo">0.0 %</td>
          </tr>
          <tr>
            <td class="headerItem">Date:</td>
            <td class="headerValue">2019-04-22 20:19:38</td>
            <td></td>
            <td class="headerItem">Functions:</td>
            <td class="headerCovTableEntry">0</td>
            <td class="headerCovTableEntry">17</td>
            <td class="headerCovTableEntryLo">0.0 %</td>
          </tr>
          <tr><td><img src="../glass.png" width=3 height=3 alt=""></td></tr>
        </table>
      </td>
    </tr>

    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>
  </table>

  <table cellpadding=0 cellspacing=0 border=0>
    <tr>
      <td><br></td>
    </tr>
    <tr>
      <td>
<pre class="sourceHeading">          Line data    Source code</pre>
<pre class="source">
<a name="1"><span class="lineNum">       1 </span>            : /* GNU test program (ksb and mjb) */</a>
<span class="lineNum">       2 </span>            : 
<span class="lineNum">       3 </span>            : /* Modified to run with the GNU shell by bfox. */
<span class="lineNum">       4 </span>            : 
<span class="lineNum">       5 </span>            : /* Copyright (C) 1987-2016 Free Software Foundation, Inc.
<span class="lineNum">       6 </span>            : 
<span class="lineNum">       7 </span>            :    This program is free software: you can redistribute it and/or modify
<span class="lineNum">       8 </span>            :    it under the terms of the GNU General Public License as published by
<span class="lineNum">       9 </span>            :    the Free Software Foundation, either version 3 of the License, or
<span class="lineNum">      10 </span>            :    (at your option) any later version.
<span class="lineNum">      11 </span>            : 
<span class="lineNum">      12 </span>            :    This program is distributed in the hope that it will be useful,
<span class="lineNum">      13 </span>            :    but WITHOUT ANY WARRANTY; without even the implied warranty of
<span class="lineNum">      14 </span>            :    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
<span class="lineNum">      15 </span>            :    GNU General Public License for more details.
<span class="lineNum">      16 </span>            : 
<span class="lineNum">      17 </span>            :    You should have received a copy of the GNU General Public License
<span class="lineNum">      18 </span>            :    along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.  */
<span class="lineNum">      19 </span>            : 
<span class="lineNum">      20 </span>            : /* Define TEST_STANDALONE to get the /bin/test version.  Otherwise, you get
<span class="lineNum">      21 </span>            :    the shell builtin version. */
<span class="lineNum">      22 </span>            : 
<span class="lineNum">      23 </span>            : /* Without this pragma, gcc 4.6.2 20111027 mistakenly suggests that
<span class="lineNum">      24 </span>            :    the advance function might be candidate for attribute 'pure'.  */
<span class="lineNum">      25 </span>            : #if (__GNUC__ == 4 &amp;&amp; 6 &lt;= __GNUC_MINOR__) || 4 &lt; __GNUC__
<span class="lineNum">      26 </span>            : # pragma GCC diagnostic ignored &quot;-Wsuggest-attribute=pure&quot;
<span class="lineNum">      27 </span>            : #endif
<span class="lineNum">      28 </span>            : 
<span class="lineNum">      29 </span>            : #include &lt;config.h&gt;
<span class="lineNum">      30 </span>            : #include &lt;stdio.h&gt;
<span class="lineNum">      31 </span>            : #include &lt;sys/types.h&gt;
<span class="lineNum">      32 </span>            : 
<span class="lineNum">      33 </span>            : #define TEST_STANDALONE 1
<span class="lineNum">      34 </span>            : 
<span class="lineNum">      35 </span>            : #ifndef LBRACKET
<span class="lineNum">      36 </span>            : # define LBRACKET 0
<span class="lineNum">      37 </span>            : #endif
<span class="lineNum">      38 </span>            : 
<span class="lineNum">      39 </span>            : /* The official name of this program (e.g., no 'g' prefix).  */
<span class="lineNum">      40 </span>            : #if LBRACKET
<span class="lineNum">      41 </span>            : # define PROGRAM_NAME &quot;[&quot;
<span class="lineNum">      42 </span>            : #else
<span class="lineNum">      43 </span>            : # define PROGRAM_NAME &quot;test&quot;
<span class="lineNum">      44 </span>            : #endif
<span class="lineNum">      45 </span>            : 
<span class="lineNum">      46 </span>            : #include &quot;system.h&quot;
<span class="lineNum">      47 </span>            : #include &quot;quote.h&quot;
<span class="lineNum">      48 </span>            : #include &quot;stat-time.h&quot;
<span class="lineNum">      49 </span>            : #include &quot;strnumcmp.h&quot;
<span class="lineNum">      50 </span>            : 
<span class="lineNum">      51 </span>            : #include &lt;stdarg.h&gt;
<span class="lineNum">      52 </span>            : #include &quot;verror.h&quot;
<span class="lineNum">      53 </span>            : 
<span class="lineNum">      54 </span>            : #if HAVE_SYS_PARAM_H
<span class="lineNum">      55 </span>            : # include &lt;sys/param.h&gt;
<span class="lineNum">      56 </span>            : #endif
<span class="lineNum">      57 </span>            : 
<span class="lineNum">      58 </span>            : /* Exit status for syntax errors, etc.  */
<span class="lineNum">      59 </span>            : enum { TEST_TRUE, TEST_FALSE, TEST_FAILURE };
<span class="lineNum">      60 </span>            : 
<span class="lineNum">      61 </span>            : #if defined TEST_STANDALONE
<span class="lineNum">      62 </span>            : # define test_exit(val) exit (val)
<span class="lineNum">      63 </span>            : # define test_main_return(val) return val
<span class="lineNum">      64 </span>            : #else
<span class="lineNum">      65 </span>            :    static jmp_buf test_exit_buf;
<span class="lineNum">      66 </span>            :    static int test_error_return = 0;
<span class="lineNum">      67 </span>            : # define test_exit(val) test_error_return = val, longjmp (test_exit_buf, 1)
<span class="lineNum">      68 </span>            : # define test_main_return(val) test_exit (val)
<span class="lineNum">      69 </span>            : #endif /* !TEST_STANDALONE */
<span class="lineNum">      70 </span>            : 
<span class="lineNum">      71 </span>            : static int pos;         /* The offset of the current argument in ARGV. */
<span class="lineNum">      72 </span>            : static int argc;        /* The number of arguments present in ARGV. */
<span class="lineNum">      73 </span>            : static char **argv;     /* The argument list. */
<span class="lineNum">      74 </span>            : 
<span class="lineNum">      75 </span>            : static bool test_unop (char const *s);
<span class="lineNum">      76 </span>            : static bool unary_operator (void);
<span class="lineNum">      77 </span>            : static bool binary_operator (bool);
<span class="lineNum">      78 </span>            : static bool two_arguments (void);
<span class="lineNum">      79 </span>            : static bool three_arguments (void);
<span class="lineNum">      80 </span>            : static bool posixtest (int);
<span class="lineNum">      81 </span>            : 
<span class="lineNum">      82 </span>            : static bool expr (void);
<span class="lineNum">      83 </span>            : static bool term (void);
<span class="lineNum">      84 </span>            : static bool and (void);
<span class="lineNum">      85 </span>            : static bool or (void);
<span class="lineNum">      86 </span>            : 
<span class="lineNum">      87 </span>            : static void test_syntax_error (char const *format, ...)
<span class="lineNum">      88 </span>            :      ATTRIBUTE_NORETURN;
<span class="lineNum">      89 </span>            : static void beyond (void) ATTRIBUTE_NORETURN;
<a name="90"><span class="lineNum">      90 </span>            : </a>
<span class="lineNum">      91 </span>            : static void
<span class="lineNum">      92 </span><span class="lineNoCov">          0 : test_syntax_error (char const *format, ...)</span>
<span class="lineNum">      93 </span>            : {
<span class="lineNum">      94 </span>            :   va_list ap;
<span class="lineNum">      95 </span><span class="lineNoCov">          0 :   va_start (ap, format);</span>
<span class="lineNum">      96 </span><span class="lineNoCov">          0 :   verror (0, 0, format, ap);</span>
<span class="lineNum">      97 </span><span class="lineNoCov">          0 :   test_exit (TEST_FAILURE);</span>
<span class="lineNum">      98 </span>            : }
<span class="lineNum">      99 </span>            : 
<span class="lineNum">     100 </span>            : /* Increment our position in the argument list.  Check that we're not
<span class="lineNum">     101 </span>            :    past the end of the argument list.  This check is suppressed if the
<span class="lineNum">     102 </span>            :    argument is false.  */
<span class="lineNum">     103 </span>            : 
<span class="lineNum">     104 </span>            : static void
<span class="lineNum">     105 </span>            : advance (bool f)
<span class="lineNum">     106 </span>            : {
<span class="lineNum">     107 </span><span class="lineNoCov">          0 :   ++pos;</span>
<span class="lineNum">     108 </span>            : 
<span class="lineNum">     109 </span><span class="lineNoCov">          0 :   if (f &amp;&amp; pos &gt;= argc)</span>
<span class="lineNum">     110 </span><span class="lineNoCov">          0 :     beyond ();</span>
<span class="lineNum">     111 </span>            : }
<a name="112"><span class="lineNum">     112 </span>            : </a>
<span class="lineNum">     113 </span>            : static void
<span class="lineNum">     114 </span><span class="lineNoCov">          0 : unary_advance (void)</span>
<span class="lineNum">     115 </span>            : {
<span class="lineNum">     116 </span><span class="lineNoCov">          0 :   advance (true);</span>
<span class="lineNum">     117 </span><span class="lineNoCov">          0 :   ++pos;</span>
<span class="lineNum">     118 </span><span class="lineNoCov">          0 : }</span>
<span class="lineNum">     119 </span>            : 
<span class="lineNum">     120 </span>            : /*
<span class="lineNum">     121 </span>            :  * beyond - call when we're beyond the end of the argument list (an
<span class="lineNum">     122 </span>            :  *      error condition)
<a name="123"><span class="lineNum">     123 </span>            :  */</a>
<span class="lineNum">     124 </span>            : static void
<span class="lineNum">     125 </span><span class="lineNoCov">          0 : beyond (void)</span>
<span class="lineNum">     126 </span>            : {
<span class="lineNum">     127 </span><span class="lineNoCov">          0 :   test_syntax_error (_(&quot;missing argument after %s&quot;), quote (argv[argc - 1]));</span>
<span class="lineNum">     128 </span>            : }
<span class="lineNum">     129 </span>            : 
<span class="lineNum">     130 </span>            : /* If the characters pointed to by STRING constitute a valid number,
<span class="lineNum">     131 </span>            :    return a pointer to the start of the number, skipping any blanks or
<a name="132"><span class="lineNum">     132 </span>            :    leading '+'.  Otherwise, report an error and exit.  */</a>
<span class="lineNum">     133 </span>            : static char const *
<span class="lineNum">     134 </span><span class="lineNoCov">          0 : find_int (char const *string)</span>
<span class="lineNum">     135 </span>            : {
<span class="lineNum">     136 </span>            :   char const *p;
<span class="lineNum">     137 </span>            :   char const *number_start;
<span class="lineNum">     138 </span>            : 
<span class="lineNum">     139 </span><span class="lineNoCov">          0 :   for (p = string; isblank (to_uchar (*p)); p++)</span>
<span class="lineNum">     140 </span><span class="lineNoCov">          0 :     continue;</span>
<span class="lineNum">     141 </span>            : 
<span class="lineNum">     142 </span><span class="lineNoCov">          0 :   if (*p == '+')</span>
<span class="lineNum">     143 </span>            :     {
<span class="lineNum">     144 </span><span class="lineNoCov">          0 :       p++;</span>
<span class="lineNum">     145 </span><span class="lineNoCov">          0 :       number_start = p;</span>
<span class="lineNum">     146 </span>            :     }
<span class="lineNum">     147 </span>            :   else
<span class="lineNum">     148 </span>            :     {
<span class="lineNum">     149 </span><span class="lineNoCov">          0 :       number_start = p;</span>
<span class="lineNum">     150 </span><span class="lineNoCov">          0 :       p += (*p == '-');</span>
<span class="lineNum">     151 </span>            :     }
<span class="lineNum">     152 </span>            : 
<span class="lineNum">     153 </span><span class="lineNoCov">          0 :   if (ISDIGIT (*p++))</span>
<span class="lineNum">     154 </span>            :     {
<span class="lineNum">     155 </span><span class="lineNoCov">          0 :       while (ISDIGIT (*p))</span>
<span class="lineNum">     156 </span><span class="lineNoCov">          0 :         p++;</span>
<span class="lineNum">     157 </span><span class="lineNoCov">          0 :       while (isblank (to_uchar (*p)))</span>
<span class="lineNum">     158 </span><span class="lineNoCov">          0 :         p++;</span>
<span class="lineNum">     159 </span><span class="lineNoCov">          0 :       if (!*p)</span>
<span class="lineNum">     160 </span><span class="lineNoCov">          0 :         return number_start;</span>
<span class="lineNum">     161 </span>            :     }
<span class="lineNum">     162 </span>            : 
<span class="lineNum">     163 </span><span class="lineNoCov">          0 :   test_syntax_error (_(&quot;invalid integer %s&quot;), quote (string));</span>
<span class="lineNum">     164 </span>            : }
<span class="lineNum">     165 </span>            : 
<span class="lineNum">     166 </span>            : /* Find the modification time of FILE, and stuff it into *MTIME.
<a name="167"><span class="lineNum">     167 </span>            :    Return true if successful.  */</a>
<span class="lineNum">     168 </span>            : static bool
<span class="lineNum">     169 </span><span class="lineNoCov">          0 : get_mtime (char const *filename, struct timespec *mtime)</span>
<span class="lineNum">     170 </span>            : {
<span class="lineNum">     171 </span>            :   struct stat finfo;
<span class="lineNum">     172 </span><span class="lineNoCov">          0 :   bool ok = (stat (filename, &amp;finfo) == 0);</span>
<span class="lineNum">     173 </span>            : #ifdef lint
<span class="lineNum">     174 </span>            :   static struct timespec const zero;
<span class="lineNum">     175 </span><span class="lineNoCov">          0 :   *mtime = zero;</span>
<span class="lineNum">     176 </span>            : #endif
<span class="lineNum">     177 </span><span class="lineNoCov">          0 :   if (ok)</span>
<span class="lineNum">     178 </span><span class="lineNoCov">          0 :     *mtime = get_stat_mtime (&amp;finfo);</span>
<span class="lineNum">     179 </span><span class="lineNoCov">          0 :   return ok;</span>
<span class="lineNum">     180 </span>            : }
<span class="lineNum">     181 </span>            : 
<a name="182"><span class="lineNum">     182 </span>            : /* Return true if S is one of the test command's binary operators.  */</a>
<span class="lineNum">     183 </span>            : static bool
<span class="lineNum">     184 </span><span class="lineNoCov">          0 : binop (char const *s)</span>
<span class="lineNum">     185 </span>            : {
<span class="lineNum">     186 </span><span class="lineNoCov">          0 :   return ((STREQ (s,   &quot;=&quot;)) || (STREQ (s,  &quot;!=&quot;)) || (STREQ (s, &quot;==&quot;)) ||</span>
<span class="lineNum">     187 </span><span class="lineNoCov">          0 :           (STREQ (s,   &quot;-nt&quot;)) ||</span>
<span class="lineNum">     188 </span><span class="lineNoCov">          0 :           (STREQ (s, &quot;-ot&quot;)) || (STREQ (s, &quot;-ef&quot;)) || (STREQ (s, &quot;-eq&quot;)) ||</span>
<span class="lineNum">     189 </span><span class="lineNoCov">          0 :           (STREQ (s, &quot;-ne&quot;)) || (STREQ (s, &quot;-lt&quot;)) || (STREQ (s, &quot;-le&quot;)) ||</span>
<span class="lineNum">     190 </span><span class="lineNoCov">          0 :           (STREQ (s, &quot;-gt&quot;)) || (STREQ (s, &quot;-ge&quot;)));</span>
<span class="lineNum">     191 </span>            : }
<span class="lineNum">     192 </span>            : 
<span class="lineNum">     193 </span>            : /*
<span class="lineNum">     194 </span>            :  * term - parse a term and return 1 or 0 depending on whether the term
<span class="lineNum">     195 </span>            :  *      evaluates to true or false, respectively.
<span class="lineNum">     196 </span>            :  *
<span class="lineNum">     197 </span>            :  * term ::=
<span class="lineNum">     198 </span>            :  *      '-'('h'|'d'|'f'|'r'|'s'|'w'|'c'|'b'|'p'|'u'|'g'|'k') filename
<span class="lineNum">     199 </span>            :  *      '-'('L'|'x') filename
<span class="lineNum">     200 </span>            :  *      '-t' int
<span class="lineNum">     201 </span>            :  *      '-'('z'|'n') string
<span class="lineNum">     202 </span>            :  *      string
<span class="lineNum">     203 </span>            :  *      string ('!='|'=') string
<span class="lineNum">     204 </span>            :  *      &lt;int&gt; '-'(eq|ne|le|lt|ge|gt) &lt;int&gt;
<span class="lineNum">     205 </span>            :  *      file '-'(nt|ot|ef) file
<span class="lineNum">     206 </span>            :  *      '(' &lt;expr&gt; ')'
<span class="lineNum">     207 </span>            :  * int ::=
<span class="lineNum">     208 </span>            :  *      '-l' string
<span class="lineNum">     209 </span>            :  *      positive and negative integers
<a name="210"><span class="lineNum">     210 </span>            :  */</a>
<span class="lineNum">     211 </span>            : static bool
<span class="lineNum">     212 </span><span class="lineNoCov">          0 : term (void)</span>
<span class="lineNum">     213 </span>            : {
<span class="lineNum">     214 </span>            :   bool value;
<span class="lineNum">     215 </span><span class="lineNoCov">          0 :   bool negated = false;</span>
<span class="lineNum">     216 </span>            : 
<span class="lineNum">     217 </span>            :   /* Deal with leading 'not's.  */
<span class="lineNum">     218 </span><span class="lineNoCov">          0 :   while (pos &lt; argc &amp;&amp; argv[pos][0] == '!' &amp;&amp; argv[pos][1] == '\0')</span>
<span class="lineNum">     219 </span>            :     {
<span class="lineNum">     220 </span><span class="lineNoCov">          0 :       advance (true);</span>
<span class="lineNum">     221 </span><span class="lineNoCov">          0 :       negated = !negated;</span>
<span class="lineNum">     222 </span>            :     }
<span class="lineNum">     223 </span>            : 
<span class="lineNum">     224 </span><span class="lineNoCov">          0 :   if (pos &gt;= argc)</span>
<span class="lineNum">     225 </span><span class="lineNoCov">          0 :     beyond ();</span>
<span class="lineNum">     226 </span>            : 
<span class="lineNum">     227 </span>            :   /* A paren-bracketed argument. */
<span class="lineNum">     228 </span><span class="lineNoCov">          0 :   if (argv[pos][0] == '(' &amp;&amp; argv[pos][1] == '\0')</span>
<span class="lineNum">     229 </span>            :     {
<span class="lineNum">     230 </span>            :       int nargs;
<span class="lineNum">     231 </span>            : 
<span class="lineNum">     232 </span>            :       advance (true);
<span class="lineNum">     233 </span>            : 
<span class="lineNum">     234 </span><span class="lineNoCov">          0 :       for (nargs = 1;</span>
<span class="lineNum">     235 </span><span class="lineNoCov">          0 :            pos + nargs &lt; argc &amp;&amp; ! STREQ (argv[pos + nargs], &quot;)&quot;);</span>
<span class="lineNum">     236 </span><span class="lineNoCov">          0 :            nargs++)</span>
<span class="lineNum">     237 </span><span class="lineNoCov">          0 :         if (nargs == 4)</span>
<span class="lineNum">     238 </span>            :           {
<span class="lineNum">     239 </span><span class="lineNoCov">          0 :             nargs = argc - pos;</span>
<span class="lineNum">     240 </span><span class="lineNoCov">          0 :             break;</span>
<span class="lineNum">     241 </span>            :           }
<span class="lineNum">     242 </span>            : 
<span class="lineNum">     243 </span><span class="lineNoCov">          0 :       value = posixtest (nargs);</span>
<span class="lineNum">     244 </span><span class="lineNoCov">          0 :       if (argv[pos] == 0)</span>
<span class="lineNum">     245 </span><span class="lineNoCov">          0 :         test_syntax_error (_(&quot;%s expected&quot;), quote (&quot;)&quot;));</span>
<span class="lineNum">     246 </span>            :       else
<span class="lineNum">     247 </span><span class="lineNoCov">          0 :         if (argv[pos][0] != ')' || argv[pos][1])</span>
<span class="lineNum">     248 </span><span class="lineNoCov">          0 :           test_syntax_error (_(&quot;%s expected, found %s&quot;),</span>
<span class="lineNum">     249 </span>            :                              quote_n (0, &quot;)&quot;), quote_n (1, argv[pos]));
<span class="lineNum">     250 </span>            :       advance (false);
<span class="lineNum">     251 </span>            :     }
<span class="lineNum">     252 </span>            : 
<span class="lineNum">     253 </span>            :   /* Are there enough arguments left that this could be dyadic?  */
<span class="lineNum">     254 </span><span class="lineNoCov">          0 :   else if (4 &lt;= argc - pos &amp;&amp; STREQ (argv[pos], &quot;-l&quot;) &amp;&amp; binop (argv[pos + 2]))</span>
<span class="lineNum">     255 </span><span class="lineNoCov">          0 :     value = binary_operator (true);</span>
<span class="lineNum">     256 </span><span class="lineNoCov">          0 :   else if (3 &lt;= argc - pos &amp;&amp; binop (argv[pos + 1]))</span>
<span class="lineNum">     257 </span><span class="lineNoCov">          0 :     value = binary_operator (false);</span>
<span class="lineNum">     258 </span>            : 
<span class="lineNum">     259 </span>            :   /* It might be a switch type argument.  */
<span class="lineNum">     260 </span><span class="lineNoCov">          0 :   else if (argv[pos][0] == '-' &amp;&amp; argv[pos][1] &amp;&amp; argv[pos][2] == '\0')</span>
<span class="lineNum">     261 </span>            :     {
<span class="lineNum">     262 </span><span class="lineNoCov">          0 :       if (test_unop (argv[pos]))</span>
<span class="lineNum">     263 </span><span class="lineNoCov">          0 :         value = unary_operator ();</span>
<span class="lineNum">     264 </span>            :       else
<span class="lineNum">     265 </span><span class="lineNoCov">          0 :         test_syntax_error (_(&quot;%s: unary operator expected&quot;), quote (argv[pos]));</span>
<span class="lineNum">     266 </span>            :     }
<span class="lineNum">     267 </span>            :   else
<span class="lineNum">     268 </span>            :     {
<span class="lineNum">     269 </span><span class="lineNoCov">          0 :       value = (argv[pos][0] != '\0');</span>
<span class="lineNum">     270 </span>            :       advance (false);
<span class="lineNum">     271 </span>            :     }
<span class="lineNum">     272 </span>            : 
<span class="lineNum">     273 </span><span class="lineNoCov">          0 :   return negated ^ value;</span>
<span class="lineNum">     274 </span>            : }
<a name="275"><span class="lineNum">     275 </span>            : </a>
<span class="lineNum">     276 </span>            : static bool
<span class="lineNum">     277 </span><span class="lineNoCov">          0 : binary_operator (bool l_is_l)</span>
<span class="lineNum">     278 </span>            : {
<span class="lineNum">     279 </span>            :   int op;
<span class="lineNum">     280 </span>            :   struct stat stat_buf, stat_spare;
<span class="lineNum">     281 </span>            :   /* Is the right integer expression of the form '-l string'? */
<span class="lineNum">     282 </span>            :   bool r_is_l;
<span class="lineNum">     283 </span>            : 
<span class="lineNum">     284 </span><span class="lineNoCov">          0 :   if (l_is_l)</span>
<span class="lineNum">     285 </span>            :     advance (false);
<span class="lineNum">     286 </span><span class="lineNoCov">          0 :   op = pos + 1;</span>
<span class="lineNum">     287 </span>            : 
<span class="lineNum">     288 </span><span class="lineNoCov">          0 :   if ((op &lt; argc - 2) &amp;&amp; STREQ (argv[op + 1], &quot;-l&quot;))</span>
<span class="lineNum">     289 </span>            :     {
<span class="lineNum">     290 </span><span class="lineNoCov">          0 :       r_is_l = true;</span>
<span class="lineNum">     291 </span>            :       advance (false);
<span class="lineNum">     292 </span>            :     }
<span class="lineNum">     293 </span>            :   else
<span class="lineNum">     294 </span>            :     r_is_l = false;
<span class="lineNum">     295 </span>            : 
<span class="lineNum">     296 </span><span class="lineNoCov">          0 :   if (argv[op][0] == '-')</span>
<span class="lineNum">     297 </span>            :     {
<span class="lineNum">     298 </span>            :       /* check for eq, nt, and stuff */
<span class="lineNum">     299 </span><span class="lineNoCov">          0 :       if ((((argv[op][1] == 'l' || argv[op][1] == 'g')</span>
<span class="lineNum">     300 </span><span class="lineNoCov">          0 :             &amp;&amp; (argv[op][2] == 'e' || argv[op][2] == 't'))</span>
<span class="lineNum">     301 </span><span class="lineNoCov">          0 :            || (argv[op][1] == 'e' &amp;&amp; argv[op][2] == 'q')</span>
<span class="lineNum">     302 </span><span class="lineNoCov">          0 :            || (argv[op][1] == 'n' &amp;&amp; argv[op][2] == 'e'))</span>
<span class="lineNum">     303 </span><span class="lineNoCov">          0 :           &amp;&amp; !argv[op][3])</span>
<span class="lineNum">     304 </span>            :         {
<span class="lineNum">     305 </span>            :           char lbuf[INT_BUFSIZE_BOUND (uintmax_t)];
<span class="lineNum">     306 </span>            :           char rbuf[INT_BUFSIZE_BOUND (uintmax_t)];
<span class="lineNum">     307 </span><span class="lineNoCov">          0 :           char const *l = (l_is_l</span>
<span class="lineNum">     308 </span><span class="lineNoCov">          0 :                            ? umaxtostr (strlen (argv[op - 1]), lbuf)</span>
<span class="lineNum">     309 </span><span class="lineNoCov">          0 :                            : find_int (argv[op - 1]));</span>
<span class="lineNum">     310 </span><span class="lineNoCov">          0 :           char const *r = (r_is_l</span>
<span class="lineNum">     311 </span><span class="lineNoCov">          0 :                            ? umaxtostr (strlen (argv[op + 2]), rbuf)</span>
<span class="lineNum">     312 </span><span class="lineNoCov">          0 :                            : find_int (argv[op + 1]));</span>
<span class="lineNum">     313 </span><span class="lineNoCov">          0 :           int cmp = strintcmp (l, r);</span>
<span class="lineNum">     314 </span><span class="lineNoCov">          0 :           bool xe_operator = (argv[op][2] == 'e');</span>
<span class="lineNum">     315 </span><span class="lineNoCov">          0 :           pos += 3;</span>
<span class="lineNum">     316 </span><span class="lineNoCov">          0 :           return (argv[op][1] == 'l' ? cmp &lt; xe_operator</span>
<span class="lineNum">     317 </span><span class="lineNoCov">          0 :                   : argv[op][1] == 'g' ? cmp &gt; - xe_operator</span>
<span class="lineNum">     318 </span><span class="lineNoCov">          0 :                   : (cmp != 0) == xe_operator);</span>
<span class="lineNum">     319 </span>            :         }
<span class="lineNum">     320 </span>            : 
<span class="lineNum">     321 </span><span class="lineNoCov">          0 :       switch (argv[op][1])</span>
<span class="lineNum">     322 </span>            :         {
<span class="lineNum">     323 </span>            :         default:
<span class="lineNum">     324 </span>            :           break;
<span class="lineNum">     325 </span>            : 
<span class="lineNum">     326 </span>            :         case 'n':
<span class="lineNum">     327 </span><span class="lineNoCov">          0 :           if (argv[op][2] == 't' &amp;&amp; !argv[op][3])</span>
<span class="lineNum">     328 </span>            :             {
<span class="lineNum">     329 </span>            :               /* nt - newer than */
<span class="lineNum">     330 </span>            :               struct timespec lt, rt;
<span class="lineNum">     331 </span>            :               bool le, re;
<span class="lineNum">     332 </span><span class="lineNoCov">          0 :               pos += 3;</span>
<span class="lineNum">     333 </span><span class="lineNoCov">          0 :               if (l_is_l || r_is_l)</span>
<span class="lineNum">     334 </span><span class="lineNoCov">          0 :                 test_syntax_error (_(&quot;-nt does not accept -l&quot;), NULL);</span>
<span class="lineNum">     335 </span><span class="lineNoCov">          0 :               le = get_mtime (argv[op - 1], &amp;lt);</span>
<span class="lineNum">     336 </span><span class="lineNoCov">          0 :               re = get_mtime (argv[op + 1], &amp;rt);</span>
<span class="lineNum">     337 </span><span class="lineNoCov">          0 :               return le &amp;&amp; (!re || timespec_cmp (lt, rt) &gt; 0);</span>
<span class="lineNum">     338 </span>            :             }
<span class="lineNum">     339 </span>            :           break;
<span class="lineNum">     340 </span>            : 
<span class="lineNum">     341 </span>            :         case 'e':
<span class="lineNum">     342 </span><span class="lineNoCov">          0 :           if (argv[op][2] == 'f' &amp;&amp; !argv[op][3])</span>
<span class="lineNum">     343 </span>            :             {
<span class="lineNum">     344 </span>            :               /* ef - hard link? */
<span class="lineNum">     345 </span><span class="lineNoCov">          0 :               pos += 3;</span>
<span class="lineNum">     346 </span><span class="lineNoCov">          0 :               if (l_is_l || r_is_l)</span>
<span class="lineNum">     347 </span><span class="lineNoCov">          0 :                 test_syntax_error (_(&quot;-ef does not accept -l&quot;), NULL);</span>
<span class="lineNum">     348 </span><span class="lineNoCov">          0 :               return (stat (argv[op - 1], &amp;stat_buf) == 0</span>
<span class="lineNum">     349 </span><span class="lineNoCov">          0 :                       &amp;&amp; stat (argv[op + 1], &amp;stat_spare) == 0</span>
<span class="lineNum">     350 </span><span class="lineNoCov">          0 :                       &amp;&amp; stat_buf.st_dev == stat_spare.st_dev</span>
<span class="lineNum">     351 </span><span class="lineNoCov">          0 :                       &amp;&amp; stat_buf.st_ino == stat_spare.st_ino);</span>
<span class="lineNum">     352 </span>            :             }
<span class="lineNum">     353 </span>            :           break;
<span class="lineNum">     354 </span>            : 
<span class="lineNum">     355 </span>            :         case 'o':
<span class="lineNum">     356 </span><span class="lineNoCov">          0 :           if ('t' == argv[op][2] &amp;&amp; '\000' == argv[op][3])</span>
<span class="lineNum">     357 </span>            :             {
<span class="lineNum">     358 </span>            :               /* ot - older than */
<span class="lineNum">     359 </span>            :               struct timespec lt, rt;
<span class="lineNum">     360 </span>            :               bool le, re;
<span class="lineNum">     361 </span><span class="lineNoCov">          0 :               pos += 3;</span>
<span class="lineNum">     362 </span><span class="lineNoCov">          0 :               if (l_is_l || r_is_l)</span>
<span class="lineNum">     363 </span><span class="lineNoCov">          0 :                 test_syntax_error (_(&quot;-ot does not accept -l&quot;), NULL);</span>
<span class="lineNum">     364 </span><span class="lineNoCov">          0 :               le = get_mtime (argv[op - 1], &amp;lt);</span>
<span class="lineNum">     365 </span><span class="lineNoCov">          0 :               re = get_mtime (argv[op + 1], &amp;rt);</span>
<span class="lineNum">     366 </span><span class="lineNoCov">          0 :               return re &amp;&amp; (!le || timespec_cmp (lt, rt) &lt; 0);</span>
<span class="lineNum">     367 </span>            :             }
<span class="lineNum">     368 </span>            :           break;
<span class="lineNum">     369 </span>            :         }
<span class="lineNum">     370 </span>            : 
<span class="lineNum">     371 </span>            :       /* FIXME: is this dead code? */
<span class="lineNum">     372 </span><span class="lineNoCov">          0 :       test_syntax_error (_(&quot;%s: unknown binary operator&quot;), quote (argv[op]));</span>
<span class="lineNum">     373 </span>            :     }
<span class="lineNum">     374 </span>            : 
<span class="lineNum">     375 </span><span class="lineNoCov">          0 :   if (argv[op][0] == '='</span>
<span class="lineNum">     376 </span><span class="lineNoCov">          0 :       &amp;&amp; (!argv[op][1] || ((argv[op][1] == '=') &amp;&amp; !argv[op][2])))</span>
<span class="lineNum">     377 </span>            :     {
<span class="lineNum">     378 </span><span class="lineNoCov">          0 :       bool value = STREQ (argv[pos], argv[pos + 2]);</span>
<span class="lineNum">     379 </span><span class="lineNoCov">          0 :       pos += 3;</span>
<span class="lineNum">     380 </span><span class="lineNoCov">          0 :       return value;</span>
<span class="lineNum">     381 </span>            :     }
<span class="lineNum">     382 </span>            : 
<span class="lineNum">     383 </span><span class="lineNoCov">          0 :   if (STREQ (argv[op], &quot;!=&quot;))</span>
<span class="lineNum">     384 </span>            :     {
<span class="lineNum">     385 </span><span class="lineNoCov">          0 :       bool value = !STREQ (argv[pos], argv[pos + 2]);</span>
<span class="lineNum">     386 </span><span class="lineNoCov">          0 :       pos += 3;</span>
<span class="lineNum">     387 </span><span class="lineNoCov">          0 :       return value;</span>
<span class="lineNum">     388 </span>            :     }
<span class="lineNum">     389 </span>            : 
<span class="lineNum">     390 </span>            :   /* Not reached.  */
<span class="lineNum">     391 </span><span class="lineNoCov">          0 :   abort ();</span>
<span class="lineNum">     392 </span>            : }
<a name="393"><span class="lineNum">     393 </span>            : </a>
<span class="lineNum">     394 </span>            : static bool
<span class="lineNum">     395 </span><span class="lineNoCov">          0 : unary_operator (void)</span>
<span class="lineNum">     396 </span>            : {
<span class="lineNum">     397 </span>            :   struct stat stat_buf;
<span class="lineNum">     398 </span>            : 
<span class="lineNum">     399 </span><span class="lineNoCov">          0 :   switch (argv[pos][1])</span>
<span class="lineNum">     400 </span>            :     {
<span class="lineNum">     401 </span>            :     default:
<span class="lineNum">     402 </span>            :       return false;
<span class="lineNum">     403 </span>            : 
<span class="lineNum">     404 </span>            :       /* All of the following unary operators use unary_advance (), which
<span class="lineNum">     405 </span>            :          checks to make sure that there is an argument, and then advances
<span class="lineNum">     406 </span>            :          pos right past it.  This means that pos - 1 is the location of the
<span class="lineNum">     407 </span>            :          argument. */
<span class="lineNum">     408 </span>            : 
<span class="lineNum">     409 </span>            :     case 'a':                   /* file exists in the file system? */
<span class="lineNum">     410 </span>            :     case 'e':
<span class="lineNum">     411 </span><span class="lineNoCov">          0 :       unary_advance ();</span>
<span class="lineNum">     412 </span><span class="lineNoCov">          0 :       return stat (argv[pos - 1], &amp;stat_buf) == 0;</span>
<span class="lineNum">     413 </span>            : 
<span class="lineNum">     414 </span>            :     case 'r':                   /* file is readable? */
<span class="lineNum">     415 </span><span class="lineNoCov">          0 :       unary_advance ();</span>
<span class="lineNum">     416 </span><span class="lineNoCov">          0 :       return euidaccess (argv[pos - 1], R_OK) == 0;</span>
<span class="lineNum">     417 </span>            : 
<span class="lineNum">     418 </span>            :     case 'w':                   /* File is writable? */
<span class="lineNum">     419 </span><span class="lineNoCov">          0 :       unary_advance ();</span>
<span class="lineNum">     420 </span><span class="lineNoCov">          0 :       return euidaccess (argv[pos - 1], W_OK) == 0;</span>
<span class="lineNum">     421 </span>            : 
<span class="lineNum">     422 </span>            :     case 'x':                   /* File is executable? */
<span class="lineNum">     423 </span><span class="lineNoCov">          0 :       unary_advance ();</span>
<span class="lineNum">     424 </span><span class="lineNoCov">          0 :       return euidaccess (argv[pos - 1], X_OK) == 0;</span>
<span class="lineNum">     425 </span>            : 
<span class="lineNum">     426 </span>            :     case 'O':                   /* File is owned by you? */
<span class="lineNum">     427 </span>            :       {
<span class="lineNum">     428 </span><span class="lineNoCov">          0 :         unary_advance ();</span>
<span class="lineNum">     429 </span><span class="lineNoCov">          0 :         if (stat (argv[pos - 1], &amp;stat_buf) != 0)</span>
<span class="lineNum">     430 </span>            :           return false;
<span class="lineNum">     431 </span><span class="lineNoCov">          0 :         errno = 0;</span>
<span class="lineNum">     432 </span><span class="lineNoCov">          0 :         uid_t euid = geteuid ();</span>
<span class="lineNum">     433 </span><span class="lineNoCov">          0 :         uid_t NO_UID = -1;</span>
<span class="lineNum">     434 </span><span class="lineNoCov">          0 :         return ! (euid == NO_UID &amp;&amp; errno) &amp;&amp; euid == stat_buf.st_uid;</span>
<span class="lineNum">     435 </span>            :       }
<span class="lineNum">     436 </span>            : 
<span class="lineNum">     437 </span>            :     case 'G':                   /* File is owned by your group? */
<span class="lineNum">     438 </span>            :       {
<span class="lineNum">     439 </span><span class="lineNoCov">          0 :         unary_advance ();</span>
<span class="lineNum">     440 </span><span class="lineNoCov">          0 :         if (stat (argv[pos - 1], &amp;stat_buf) != 0)</span>
<span class="lineNum">     441 </span>            :           return false;
<span class="lineNum">     442 </span><span class="lineNoCov">          0 :         errno = 0;</span>
<span class="lineNum">     443 </span><span class="lineNoCov">          0 :         gid_t egid = getegid ();</span>
<span class="lineNum">     444 </span><span class="lineNoCov">          0 :         gid_t NO_GID = -1;</span>
<span class="lineNum">     445 </span><span class="lineNoCov">          0 :         return ! (egid == NO_GID &amp;&amp; errno) &amp;&amp; egid == stat_buf.st_gid;</span>
<span class="lineNum">     446 </span>            :       }
<span class="lineNum">     447 </span>            : 
<span class="lineNum">     448 </span>            :     case 'f':                   /* File is a file? */
<span class="lineNum">     449 </span><span class="lineNoCov">          0 :       unary_advance ();</span>
<span class="lineNum">     450 </span>            :       /* Under POSIX, -f is true if the given file exists
<span class="lineNum">     451 </span>            :          and is a regular file. */
<span class="lineNum">     452 </span><span class="lineNoCov">          0 :       return (stat (argv[pos - 1], &amp;stat_buf) == 0</span>
<span class="lineNum">     453 </span><span class="lineNoCov">          0 :               &amp;&amp; S_ISREG (stat_buf.st_mode));</span>
<span class="lineNum">     454 </span>            : 
<span class="lineNum">     455 </span>            :     case 'd':                   /* File is a directory? */
<span class="lineNum">     456 </span><span class="lineNoCov">          0 :       unary_advance ();</span>
<span class="lineNum">     457 </span><span class="lineNoCov">          0 :       return (stat (argv[pos - 1], &amp;stat_buf) == 0</span>
<span class="lineNum">     458 </span><span class="lineNoCov">          0 :               &amp;&amp; S_ISDIR (stat_buf.st_mode));</span>
<span class="lineNum">     459 </span>            : 
<span class="lineNum">     460 </span>            :     case 's':                   /* File has something in it? */
<span class="lineNum">     461 </span><span class="lineNoCov">          0 :       unary_advance ();</span>
<span class="lineNum">     462 </span><span class="lineNoCov">          0 :       return (stat (argv[pos - 1], &amp;stat_buf) == 0</span>
<span class="lineNum">     463 </span><span class="lineNoCov">          0 :               &amp;&amp; 0 &lt; stat_buf.st_size);</span>
<span class="lineNum">     464 </span>            : 
<span class="lineNum">     465 </span>            :     case 'S':                   /* File is a socket? */
<span class="lineNum">     466 </span><span class="lineNoCov">          0 :       unary_advance ();</span>
<span class="lineNum">     467 </span><span class="lineNoCov">          0 :       return (stat (argv[pos - 1], &amp;stat_buf) == 0</span>
<span class="lineNum">     468 </span><span class="lineNoCov">          0 :               &amp;&amp; S_ISSOCK (stat_buf.st_mode));</span>
<span class="lineNum">     469 </span>            : 
<span class="lineNum">     470 </span>            :     case 'c':                   /* File is character special? */
<span class="lineNum">     471 </span><span class="lineNoCov">          0 :       unary_advance ();</span>
<span class="lineNum">     472 </span><span class="lineNoCov">          0 :       return (stat (argv[pos - 1], &amp;stat_buf) == 0</span>
<span class="lineNum">     473 </span><span class="lineNoCov">          0 :               &amp;&amp; S_ISCHR (stat_buf.st_mode));</span>
<span class="lineNum">     474 </span>            : 
<span class="lineNum">     475 </span>            :     case 'b':                   /* File is block special? */
<span class="lineNum">     476 </span><span class="lineNoCov">          0 :       unary_advance ();</span>
<span class="lineNum">     477 </span><span class="lineNoCov">          0 :       return (stat (argv[pos - 1], &amp;stat_buf) == 0</span>
<span class="lineNum">     478 </span><span class="lineNoCov">          0 :               &amp;&amp; S_ISBLK (stat_buf.st_mode));</span>
<span class="lineNum">     479 </span>            : 
<span class="lineNum">     480 </span>            :     case 'p':                   /* File is a named pipe? */
<span class="lineNum">     481 </span><span class="lineNoCov">          0 :       unary_advance ();</span>
<span class="lineNum">     482 </span><span class="lineNoCov">          0 :       return (stat (argv[pos - 1], &amp;stat_buf) == 0</span>
<span class="lineNum">     483 </span><span class="lineNoCov">          0 :               &amp;&amp; S_ISFIFO (stat_buf.st_mode));</span>
<span class="lineNum">     484 </span>            : 
<span class="lineNum">     485 </span>            :     case 'L':                   /* Same as -h  */
<span class="lineNum">     486 </span>            :       /*FALLTHROUGH*/
<span class="lineNum">     487 </span>            : 
<span class="lineNum">     488 </span>            :     case 'h':                   /* File is a symbolic link? */
<span class="lineNum">     489 </span><span class="lineNoCov">          0 :       unary_advance ();</span>
<span class="lineNum">     490 </span><span class="lineNoCov">          0 :       return (lstat (argv[pos - 1], &amp;stat_buf) == 0</span>
<span class="lineNum">     491 </span><span class="lineNoCov">          0 :               &amp;&amp; S_ISLNK (stat_buf.st_mode));</span>
<span class="lineNum">     492 </span>            : 
<span class="lineNum">     493 </span>            :     case 'u':                   /* File is setuid? */
<span class="lineNum">     494 </span><span class="lineNoCov">          0 :       unary_advance ();</span>
<span class="lineNum">     495 </span><span class="lineNoCov">          0 :       return (stat (argv[pos - 1], &amp;stat_buf) == 0</span>
<span class="lineNum">     496 </span><span class="lineNoCov">          0 :               &amp;&amp; (stat_buf.st_mode &amp; S_ISUID));</span>
<span class="lineNum">     497 </span>            : 
<span class="lineNum">     498 </span>            :     case 'g':                   /* File is setgid? */
<span class="lineNum">     499 </span><span class="lineNoCov">          0 :       unary_advance ();</span>
<span class="lineNum">     500 </span><span class="lineNoCov">          0 :       return (stat (argv[pos - 1], &amp;stat_buf) == 0</span>
<span class="lineNum">     501 </span><span class="lineNoCov">          0 :               &amp;&amp; (stat_buf.st_mode &amp; S_ISGID));</span>
<span class="lineNum">     502 </span>            : 
<span class="lineNum">     503 </span>            :     case 'k':                   /* File has sticky bit set? */
<span class="lineNum">     504 </span><span class="lineNoCov">          0 :       unary_advance ();</span>
<span class="lineNum">     505 </span><span class="lineNoCov">          0 :       return (stat (argv[pos - 1], &amp;stat_buf) == 0</span>
<span class="lineNum">     506 </span><span class="lineNoCov">          0 :               &amp;&amp; (stat_buf.st_mode &amp; S_ISVTX));</span>
<span class="lineNum">     507 </span>            : 
<span class="lineNum">     508 </span>            :     case 't':                   /* File (fd) is a terminal? */
<span class="lineNum">     509 </span>            :       {
<span class="lineNum">     510 </span>            :         long int fd;
<span class="lineNum">     511 </span>            :         char const *arg;
<span class="lineNum">     512 </span><span class="lineNoCov">          0 :         unary_advance ();</span>
<span class="lineNum">     513 </span><span class="lineNoCov">          0 :         arg = find_int (argv[pos - 1]);</span>
<span class="lineNum">     514 </span><span class="lineNoCov">          0 :         errno = 0;</span>
<span class="lineNum">     515 </span><span class="lineNoCov">          0 :         fd = strtol (arg, NULL, 10);</span>
<span class="lineNum">     516 </span><span class="lineNoCov">          0 :         return (errno != ERANGE &amp;&amp; 0 &lt;= fd &amp;&amp; fd &lt;= INT_MAX &amp;&amp; isatty (fd));</span>
<span class="lineNum">     517 </span>            :       }
<span class="lineNum">     518 </span>            : 
<span class="lineNum">     519 </span>            :     case 'n':                   /* True if arg has some length. */
<span class="lineNum">     520 </span><span class="lineNoCov">          0 :       unary_advance ();</span>
<span class="lineNum">     521 </span><span class="lineNoCov">          0 :       return argv[pos - 1][0] != 0;</span>
<span class="lineNum">     522 </span>            : 
<span class="lineNum">     523 </span>            :     case 'z':                   /* True if arg has no length. */
<span class="lineNum">     524 </span><span class="lineNoCov">          0 :       unary_advance ();</span>
<span class="lineNum">     525 </span><span class="lineNoCov">          0 :       return argv[pos - 1][0] == '\0';</span>
<span class="lineNum">     526 </span>            :     }
<span class="lineNum">     527 </span>            : }
<span class="lineNum">     528 </span>            : 
<span class="lineNum">     529 </span>            : /*
<span class="lineNum">     530 </span>            :  * and:
<span class="lineNum">     531 </span>            :  *      term
<span class="lineNum">     532 </span>            :  *      term '-a' and
<a name="533"><span class="lineNum">     533 </span>            :  */</a>
<span class="lineNum">     534 </span>            : static bool
<span class="lineNum">     535 </span><span class="lineNoCov">          0 : and (void)</span>
<span class="lineNum">     536 </span>            : {
<span class="lineNum">     537 </span><span class="lineNoCov">          0 :   bool value = true;</span>
<span class="lineNum">     538 </span>            : 
<span class="lineNum">     539 </span>            :   while (true)
<span class="lineNum">     540 </span>            :     {
<span class="lineNum">     541 </span><span class="lineNoCov">          0 :       value &amp;= term ();</span>
<span class="lineNum">     542 </span><span class="lineNoCov">          0 :       if (! (pos &lt; argc &amp;&amp; STREQ (argv[pos], &quot;-a&quot;)))</span>
<span class="lineNum">     543 </span><span class="lineNoCov">          0 :         return value;</span>
<span class="lineNum">     544 </span>            :       advance (false);
<span class="lineNum">     545 </span>            :     }
<span class="lineNum">     546 </span>            : }
<span class="lineNum">     547 </span>            : 
<span class="lineNum">     548 </span>            : /*
<span class="lineNum">     549 </span>            :  * or:
<span class="lineNum">     550 </span>            :  *      and
<span class="lineNum">     551 </span>            :  *      and '-o' or
<a name="552"><span class="lineNum">     552 </span>            :  */</a>
<span class="lineNum">     553 </span>            : static bool
<span class="lineNum">     554 </span><span class="lineNoCov">          0 : or (void)</span>
<span class="lineNum">     555 </span>            : {
<span class="lineNum">     556 </span><span class="lineNoCov">          0 :   bool value = false;</span>
<span class="lineNum">     557 </span>            : 
<span class="lineNum">     558 </span>            :   while (true)
<span class="lineNum">     559 </span>            :     {
<span class="lineNum">     560 </span><span class="lineNoCov">          0 :       value |= and ();</span>
<span class="lineNum">     561 </span><span class="lineNoCov">          0 :       if (! (pos &lt; argc &amp;&amp; STREQ (argv[pos], &quot;-o&quot;)))</span>
<span class="lineNum">     562 </span><span class="lineNoCov">          0 :         return value;</span>
<span class="lineNum">     563 </span>            :       advance (false);
<span class="lineNum">     564 </span>            :     }
<span class="lineNum">     565 </span>            : }
<span class="lineNum">     566 </span>            : 
<span class="lineNum">     567 </span>            : /*
<span class="lineNum">     568 </span>            :  * expr:
<span class="lineNum">     569 </span>            :  *      or
<a name="570"><span class="lineNum">     570 </span>            :  */</a>
<span class="lineNum">     571 </span>            : static bool
<span class="lineNum">     572 </span><span class="lineNoCov">          0 : expr (void)</span>
<span class="lineNum">     573 </span>            : {
<span class="lineNum">     574 </span><span class="lineNoCov">          0 :   if (pos &gt;= argc)</span>
<span class="lineNum">     575 </span><span class="lineNoCov">          0 :     beyond ();</span>
<span class="lineNum">     576 </span>            : 
<span class="lineNum">     577 </span><span class="lineNoCov">          0 :   return or ();         /* Same with this. */</span>
<span class="lineNum">     578 </span>            : }
<span class="lineNum">     579 </span>            : 
<span class="lineNum">     580 </span>            : /* Return true if OP is one of the test command's unary operators. */
<span class="lineNum">     581 </span>            : static bool
<span class="lineNum">     582 </span>            : test_unop (char const *op)
<span class="lineNum">     583 </span>            : {
<span class="lineNum">     584 </span><span class="lineNoCov">          0 :   if (op[0] != '-')</span>
<span class="lineNum">     585 </span>            :     return false;
<span class="lineNum">     586 </span>            : 
<span class="lineNum">     587 </span>            :   switch (op[1])
<span class="lineNum">     588 </span>            :     {
<span class="lineNum">     589 </span>            :     case 'a': case 'b': case 'c': case 'd': case 'e':
<span class="lineNum">     590 </span>            :     case 'f': case 'g': case 'h': case 'k': case 'n':
<span class="lineNum">     591 </span>            :     case 'o': case 'p': case 'r': case 's': case 't':
<span class="lineNum">     592 </span>            :     case 'u': case 'w': case 'x': case 'z':
<span class="lineNum">     593 </span>            :     case 'G': case 'L': case 'O': case 'S': case 'N':
<span class="lineNum">     594 </span>            :       return true;
<span class="lineNum">     595 </span>            :     default:
<span class="lineNum">     596 </span>            :       return false;
<span class="lineNum">     597 </span>            :     }
<span class="lineNum">     598 </span>            : }
<span class="lineNum">     599 </span>            : 
<span class="lineNum">     600 </span>            : static bool
<span class="lineNum">     601 </span>            : one_argument (void)
<span class="lineNum">     602 </span>            : {
<span class="lineNum">     603 </span><span class="lineNoCov">          0 :   return argv[pos++][0] != '\0';</span>
<span class="lineNum">     604 </span>            : }
<a name="605"><span class="lineNum">     605 </span>            : </a>
<span class="lineNum">     606 </span>            : static bool
<span class="lineNum">     607 </span><span class="lineNoCov">          0 : two_arguments (void)</span>
<span class="lineNum">     608 </span>            : {
<span class="lineNum">     609 </span>            :   bool value;
<span class="lineNum">     610 </span>            : 
<span class="lineNum">     611 </span><span class="lineNoCov">          0 :   if (STREQ (argv[pos], &quot;!&quot;))</span>
<span class="lineNum">     612 </span>            :     {
<span class="lineNum">     613 </span><span class="lineNoCov">          0 :       advance (false);</span>
<span class="lineNum">     614 </span><span class="lineNoCov">          0 :       value = ! one_argument ();</span>
<span class="lineNum">     615 </span>            :     }
<span class="lineNum">     616 </span><span class="lineNoCov">          0 :   else if (argv[pos][0] == '-'</span>
<span class="lineNum">     617 </span><span class="lineNoCov">          0 :            &amp;&amp; argv[pos][1] != '\0'</span>
<span class="lineNum">     618 </span><span class="lineNoCov">          0 :            &amp;&amp; argv[pos][2] == '\0')</span>
<span class="lineNum">     619 </span>            :     {
<span class="lineNum">     620 </span><span class="lineNoCov">          0 :       if (test_unop (argv[pos]))</span>
<span class="lineNum">     621 </span><span class="lineNoCov">          0 :         value = unary_operator ();</span>
<span class="lineNum">     622 </span>            :       else
<span class="lineNum">     623 </span><span class="lineNoCov">          0 :         test_syntax_error (_(&quot;%s: unary operator expected&quot;), quote (argv[pos]));</span>
<span class="lineNum">     624 </span>            :     }
<span class="lineNum">     625 </span>            :   else
<span class="lineNum">     626 </span><span class="lineNoCov">          0 :     beyond ();</span>
<span class="lineNum">     627 </span><span class="lineNoCov">          0 :   return (value);</span>
<span class="lineNum">     628 </span>            : }
<a name="629"><span class="lineNum">     629 </span>            : </a>
<span class="lineNum">     630 </span>            : static bool
<span class="lineNum">     631 </span><span class="lineNoCov">          0 : three_arguments (void)</span>
<span class="lineNum">     632 </span>            : {
<span class="lineNum">     633 </span>            :   bool value;
<span class="lineNum">     634 </span>            : 
<span class="lineNum">     635 </span><span class="lineNoCov">          0 :   if (binop (argv[pos + 1]))</span>
<span class="lineNum">     636 </span><span class="lineNoCov">          0 :     value = binary_operator (false);</span>
<span class="lineNum">     637 </span><span class="lineNoCov">          0 :   else if (STREQ (argv[pos], &quot;!&quot;))</span>
<span class="lineNum">     638 </span>            :     {
<span class="lineNum">     639 </span><span class="lineNoCov">          0 :       advance (true);</span>
<span class="lineNum">     640 </span><span class="lineNoCov">          0 :       value = !two_arguments ();</span>
<span class="lineNum">     641 </span>            :     }
<span class="lineNum">     642 </span><span class="lineNoCov">          0 :   else if (STREQ (argv[pos], &quot;(&quot;) &amp;&amp; STREQ (argv[pos + 2], &quot;)&quot;))</span>
<span class="lineNum">     643 </span>            :     {
<span class="lineNum">     644 </span><span class="lineNoCov">          0 :       advance (false);</span>
<span class="lineNum">     645 </span><span class="lineNoCov">          0 :       value = one_argument ();</span>
<span class="lineNum">     646 </span>            :       advance (false);
<span class="lineNum">     647 </span>            :     }
<span class="lineNum">     648 </span><span class="lineNoCov">          0 :   else if (STREQ (argv[pos + 1], &quot;-a&quot;) || STREQ (argv[pos + 1], &quot;-o&quot;))</span>
<span class="lineNum">     649 </span><span class="lineNoCov">          0 :     value = expr ();</span>
<span class="lineNum">     650 </span>            :   else
<span class="lineNum">     651 </span><span class="lineNoCov">          0 :     test_syntax_error (_(&quot;%s: binary operator expected&quot;), quote (argv[pos+1]));</span>
<span class="lineNum">     652 </span><span class="lineNoCov">          0 :   return (value);</span>
<span class="lineNum">     653 </span>            : }
<span class="lineNum">     654 </span>            : 
<a name="655"><span class="lineNum">     655 </span>            : /* This is an implementation of a Posix.2 proposal by David Korn. */</a>
<span class="lineNum">     656 </span>            : static bool
<span class="lineNum">     657 </span><span class="lineNoCov">          0 : posixtest (int nargs)</span>
<span class="lineNum">     658 </span>            : {
<span class="lineNum">     659 </span>            :   bool value;
<span class="lineNum">     660 </span>            : 
<span class="lineNum">     661 </span><span class="lineNoCov">          0 :   switch (nargs)</span>
<span class="lineNum">     662 </span>            :     {
<span class="lineNum">     663 </span>            :       case 1:
<span class="lineNum">     664 </span><span class="lineNoCov">          0 :         value = one_argument ();</span>
<span class="lineNum">     665 </span><span class="lineNoCov">          0 :         break;</span>
<span class="lineNum">     666 </span>            : 
<span class="lineNum">     667 </span>            :       case 2:
<span class="lineNum">     668 </span><span class="lineNoCov">          0 :         value = two_arguments ();</span>
<span class="lineNum">     669 </span><span class="lineNoCov">          0 :         break;</span>
<span class="lineNum">     670 </span>            : 
<span class="lineNum">     671 </span>            :       case 3:
<span class="lineNum">     672 </span><span class="lineNoCov">          0 :         value = three_arguments ();</span>
<span class="lineNum">     673 </span><span class="lineNoCov">          0 :         break;</span>
<span class="lineNum">     674 </span>            : 
<span class="lineNum">     675 </span>            :       case 4:
<span class="lineNum">     676 </span><span class="lineNoCov">          0 :         if (STREQ (argv[pos], &quot;!&quot;))</span>
<span class="lineNum">     677 </span>            :           {
<span class="lineNum">     678 </span><span class="lineNoCov">          0 :             advance (true);</span>
<span class="lineNum">     679 </span><span class="lineNoCov">          0 :             value = !three_arguments ();</span>
<span class="lineNum">     680 </span><span class="lineNoCov">          0 :             break;</span>
<span class="lineNum">     681 </span>            :           }
<span class="lineNum">     682 </span><span class="lineNoCov">          0 :         if (STREQ (argv[pos], &quot;(&quot;) &amp;&amp; STREQ (argv[pos + 3], &quot;)&quot;))</span>
<span class="lineNum">     683 </span>            :           {
<span class="lineNum">     684 </span><span class="lineNoCov">          0 :             advance (false);</span>
<span class="lineNum">     685 </span><span class="lineNoCov">          0 :             value = two_arguments ();</span>
<span class="lineNum">     686 </span>            :             advance (false);
<span class="lineNum">     687 </span>            :             break;
<span class="lineNum">     688 </span>            :           }
<span class="lineNum">     689 </span>            :         /* FALLTHROUGH */
<span class="lineNum">     690 </span>            :       case 5:
<span class="lineNum">     691 </span>            :       default:
<span class="lineNum">     692 </span><span class="lineNoCov">          0 :         if (nargs &lt;= 0)</span>
<span class="lineNum">     693 </span><span class="lineNoCov">          0 :           abort ();</span>
<span class="lineNum">     694 </span><span class="lineNoCov">          0 :         value = expr ();</span>
<span class="lineNum">     695 </span>            :     }
<span class="lineNum">     696 </span>            : 
<span class="lineNum">     697 </span><span class="lineNoCov">          0 :   return (value);</span>
<span class="lineNum">     698 </span>            : }
<span class="lineNum">     699 </span>            : 
<span class="lineNum">     700 </span>            : #if defined TEST_STANDALONE
<a name="701"><span class="lineNum">     701 </span>            : </a>
<span class="lineNum">     702 </span>            : void
<span class="lineNum">     703 </span><span class="lineNoCov">          0 : usage (int status)</span>
<span class="lineNum">     704 </span>            : {
<span class="lineNum">     705 </span><span class="lineNoCov">          0 :   if (status != EXIT_SUCCESS)</span>
<span class="lineNum">     706 </span><span class="lineNoCov">          0 :     emit_try_help ();</span>
<span class="lineNum">     707 </span>            :   else
<span class="lineNum">     708 </span>            :     {
<span class="lineNum">     709 </span><span class="lineNoCov">          0 :       fputs (_(&quot;\</span>
<span class="lineNum">     710 </span>            : Usage: test EXPRESSION\n\
<span class="lineNum">     711 </span>            :   or:  test\n\
<span class="lineNum">     712 </span>            :   or:  [ EXPRESSION ]\n\
<span class="lineNum">     713 </span>            :   or:  [ ]\n\
<span class="lineNum">     714 </span>            :   or:  [ OPTION\n\
<span class="lineNum">     715 </span>            : &quot;), stdout);
<span class="lineNum">     716 </span><span class="lineNoCov">          0 :       fputs (_(&quot;\</span>
<span class="lineNum">     717 </span>            : Exit with the status determined by EXPRESSION.\n\
<span class="lineNum">     718 </span>            : \n\
<span class="lineNum">     719 </span>            : &quot;), stdout);
<span class="lineNum">     720 </span><span class="lineNoCov">          0 :       fputs (HELP_OPTION_DESCRIPTION, stdout);</span>
<span class="lineNum">     721 </span><span class="lineNoCov">          0 :       fputs (VERSION_OPTION_DESCRIPTION, stdout);</span>
<span class="lineNum">     722 </span><span class="lineNoCov">          0 :       fputs (_(&quot;\</span>
<span class="lineNum">     723 </span>            : \n\
<span class="lineNum">     724 </span>            : An omitted EXPRESSION defaults to false.  Otherwise,\n\
<span class="lineNum">     725 </span>            : EXPRESSION is true or false and sets exit status.  It is one of:\n\
<span class="lineNum">     726 </span>            : &quot;), stdout);
<span class="lineNum">     727 </span><span class="lineNoCov">          0 :       fputs (_(&quot;\</span>
<span class="lineNum">     728 </span>            : \n\
<span class="lineNum">     729 </span>            :   ( EXPRESSION )               EXPRESSION is true\n\
<span class="lineNum">     730 </span>            :   ! EXPRESSION                 EXPRESSION is false\n\
<span class="lineNum">     731 </span>            :   EXPRESSION1 -a EXPRESSION2   both EXPRESSION1 and EXPRESSION2 are true\n\
<span class="lineNum">     732 </span>            :   EXPRESSION1 -o EXPRESSION2   either EXPRESSION1 or EXPRESSION2 is true\n\
<span class="lineNum">     733 </span>            : &quot;), stdout);
<span class="lineNum">     734 </span><span class="lineNoCov">          0 :       fputs (_(&quot;\</span>
<span class="lineNum">     735 </span>            : \n\
<span class="lineNum">     736 </span>            :   -n STRING            the length of STRING is nonzero\n\
<span class="lineNum">     737 </span>            :   STRING               equivalent to -n STRING\n\
<span class="lineNum">     738 </span>            :   -z STRING            the length of STRING is zero\n\
<span class="lineNum">     739 </span>            :   STRING1 = STRING2    the strings are equal\n\
<span class="lineNum">     740 </span>            :   STRING1 != STRING2   the strings are not equal\n\
<span class="lineNum">     741 </span>            : &quot;), stdout);
<span class="lineNum">     742 </span><span class="lineNoCov">          0 :       fputs (_(&quot;\</span>
<span class="lineNum">     743 </span>            : \n\
<span class="lineNum">     744 </span>            :   INTEGER1 -eq INTEGER2   INTEGER1 is equal to INTEGER2\n\
<span class="lineNum">     745 </span>            :   INTEGER1 -ge INTEGER2   INTEGER1 is greater than or equal to INTEGER2\n\
<span class="lineNum">     746 </span>            :   INTEGER1 -gt INTEGER2   INTEGER1 is greater than INTEGER2\n\
<span class="lineNum">     747 </span>            :   INTEGER1 -le INTEGER2   INTEGER1 is less than or equal to INTEGER2\n\
<span class="lineNum">     748 </span>            :   INTEGER1 -lt INTEGER2   INTEGER1 is less than INTEGER2\n\
<span class="lineNum">     749 </span>            :   INTEGER1 -ne INTEGER2   INTEGER1 is not equal to INTEGER2\n\
<span class="lineNum">     750 </span>            : &quot;), stdout);
<span class="lineNum">     751 </span><span class="lineNoCov">          0 :       fputs (_(&quot;\</span>
<span class="lineNum">     752 </span>            : \n\
<span class="lineNum">     753 </span>            :   FILE1 -ef FILE2   FILE1 and FILE2 have the same device and inode numbers\n\
<span class="lineNum">     754 </span>            :   FILE1 -nt FILE2   FILE1 is newer (modification date) than FILE2\n\
<span class="lineNum">     755 </span>            :   FILE1 -ot FILE2   FILE1 is older than FILE2\n\
<span class="lineNum">     756 </span>            : &quot;), stdout);
<span class="lineNum">     757 </span><span class="lineNoCov">          0 :       fputs (_(&quot;\</span>
<span class="lineNum">     758 </span>            : \n\
<span class="lineNum">     759 </span>            :   -b FILE     FILE exists and is block special\n\
<span class="lineNum">     760 </span>            :   -c FILE     FILE exists and is character special\n\
<span class="lineNum">     761 </span>            :   -d FILE     FILE exists and is a directory\n\
<span class="lineNum">     762 </span>            :   -e FILE     FILE exists\n\
<span class="lineNum">     763 </span>            : &quot;), stdout);
<span class="lineNum">     764 </span><span class="lineNoCov">          0 :       fputs (_(&quot;\</span>
<span class="lineNum">     765 </span>            :   -f FILE     FILE exists and is a regular file\n\
<span class="lineNum">     766 </span>            :   -g FILE     FILE exists and is set-group-ID\n\
<span class="lineNum">     767 </span>            :   -G FILE     FILE exists and is owned by the effective group ID\n\
<span class="lineNum">     768 </span>            :   -h FILE     FILE exists and is a symbolic link (same as -L)\n\
<span class="lineNum">     769 </span>            :   -k FILE     FILE exists and has its sticky bit set\n\
<span class="lineNum">     770 </span>            : &quot;), stdout);
<span class="lineNum">     771 </span><span class="lineNoCov">          0 :       fputs (_(&quot;\</span>
<span class="lineNum">     772 </span>            :   -L FILE     FILE exists and is a symbolic link (same as -h)\n\
<span class="lineNum">     773 </span>            :   -O FILE     FILE exists and is owned by the effective user ID\n\
<span class="lineNum">     774 </span>            :   -p FILE     FILE exists and is a named pipe\n\
<span class="lineNum">     775 </span>            :   -r FILE     FILE exists and read permission is granted\n\
<span class="lineNum">     776 </span>            :   -s FILE     FILE exists and has a size greater than zero\n\
<span class="lineNum">     777 </span>            : &quot;), stdout);
<span class="lineNum">     778 </span><span class="lineNoCov">          0 :       fputs (_(&quot;\</span>
<span class="lineNum">     779 </span>            :   -S FILE     FILE exists and is a socket\n\
<span class="lineNum">     780 </span>            :   -t FD       file descriptor FD is opened on a terminal\n\
<span class="lineNum">     781 </span>            :   -u FILE     FILE exists and its set-user-ID bit is set\n\
<span class="lineNum">     782 </span>            :   -w FILE     FILE exists and write permission is granted\n\
<span class="lineNum">     783 </span>            :   -x FILE     FILE exists and execute (or search) permission is granted\n\
<span class="lineNum">     784 </span>            : &quot;), stdout);
<span class="lineNum">     785 </span><span class="lineNoCov">          0 :       fputs (_(&quot;\</span>
<span class="lineNum">     786 </span>            : \n\
<span class="lineNum">     787 </span>            : Except for -h and -L, all FILE-related tests dereference symbolic links.\n\
<span class="lineNum">     788 </span>            : Beware that parentheses need to be escaped (e.g., by backslashes) for shells.\n\
<span class="lineNum">     789 </span>            : INTEGER may also be -l STRING, which evaluates to the length of STRING.\n\
<span class="lineNum">     790 </span>            : &quot;), stdout);
<span class="lineNum">     791 </span><span class="lineNoCov">          0 :       fputs (_(&quot;\</span>
<span class="lineNum">     792 </span>            : \n\
<span class="lineNum">     793 </span>            : NOTE: [ honors the --help and --version options, but test does not.\n\
<span class="lineNum">     794 </span>            : test treats each of those as it treats any other nonempty STRING.\n\
<span class="lineNum">     795 </span>            : &quot;), stdout);
<span class="lineNum">     796 </span><span class="lineNoCov">          0 :       printf (USAGE_BUILTIN_WARNING, _(&quot;test and/or [&quot;));</span>
<span class="lineNum">     797 </span><span class="lineNoCov">          0 :       emit_ancillary_info (PROGRAM_NAME);</span>
<span class="lineNum">     798 </span>            :     }
<span class="lineNum">     799 </span><span class="lineNoCov">          0 :   exit (status);</span>
<span class="lineNum">     800 </span>            : }
<span class="lineNum">     801 </span>            : #endif /* TEST_STANDALONE */
<span class="lineNum">     802 </span>            : 
<span class="lineNum">     803 </span>            : #if !defined TEST_STANDALONE
<span class="lineNum">     804 </span>            : # define main test_command
<span class="lineNum">     805 </span>            : #endif
<span class="lineNum">     806 </span>            : 
<span class="lineNum">     807 </span>            : #define AUTHORS \
<span class="lineNum">     808 </span>            :   proper_name (&quot;Kevin Braunsdorf&quot;), \
<span class="lineNum">     809 </span>            :   proper_name (&quot;Matthew Bradburn&quot;)
<span class="lineNum">     810 </span>            : 
<span class="lineNum">     811 </span>            : /*
<span class="lineNum">     812 </span>            :  * [:
<span class="lineNum">     813 </span>            :  *      '[' expr ']'
<span class="lineNum">     814 </span>            :  * test:
<span class="lineNum">     815 </span>            :  *      test expr
<a name="816"><span class="lineNum">     816 </span>            :  */</a>
<span class="lineNum">     817 </span>            : int
<span class="lineNum">     818 </span><span class="lineNoCov">          0 : main (int margc, char **margv)</span>
<span class="lineNum">     819 </span>            : {
<span class="lineNum">     820 </span>            :   bool value;
<span class="lineNum">     821 </span>            : 
<span class="lineNum">     822 </span>            : #if !defined TEST_STANDALONE
<span class="lineNum">     823 </span>            :   int code;
<span class="lineNum">     824 </span>            : 
<span class="lineNum">     825 </span>            :   code = setjmp (test_exit_buf);
<span class="lineNum">     826 </span>            : 
<span class="lineNum">     827 </span>            :   if (code)
<span class="lineNum">     828 </span>            :     return (test_error_return);
<span class="lineNum">     829 </span>            : #else /* TEST_STANDALONE */
<span class="lineNum">     830 </span>            :   initialize_main (&amp;margc, &amp;margv);
<span class="lineNum">     831 </span><span class="lineNoCov">          0 :   set_program_name (margv[0]);</span>
<span class="lineNum">     832 </span><span class="lineNoCov">          0 :   setlocale (LC_ALL, &quot;&quot;);</span>
<span class="lineNum">     833 </span><span class="lineNoCov">          0 :   bindtextdomain (PACKAGE, LOCALEDIR);</span>
<span class="lineNum">     834 </span><span class="lineNoCov">          0 :   textdomain (PACKAGE);</span>
<span class="lineNum">     835 </span>            : 
<span class="lineNum">     836 </span><span class="lineNoCov">          0 :   initialize_exit_failure (TEST_FAILURE);</span>
<span class="lineNum">     837 </span><span class="lineNoCov">          0 :   atexit (close_stdout);</span>
<span class="lineNum">     838 </span>            : #endif /* TEST_STANDALONE */
<span class="lineNum">     839 </span>            : 
<span class="lineNum">     840 </span><span class="lineNoCov">          0 :   argv = margv;</span>
<span class="lineNum">     841 </span>            : 
<span class="lineNum">     842 </span>            :   if (LBRACKET)
<span class="lineNum">     843 </span>            :     {
<span class="lineNum">     844 </span>            :       /* Recognize --help or --version, but only when invoked in the
<span class="lineNum">     845 </span>            :          &quot;[&quot; form, when the last argument is not &quot;]&quot;.  Use direct
<span class="lineNum">     846 </span>            :          parsing, rather than parse_long_options, to avoid accepting
<span class="lineNum">     847 </span>            :          abbreviations.  POSIX allows &quot;[ --help&quot; and &quot;[ --version&quot; to
<span class="lineNum">     848 </span>            :          have the usual GNU behavior, but it requires &quot;test --help&quot;
<span class="lineNum">     849 </span>            :          and &quot;test --version&quot; to exit silently with status 0.  */
<span class="lineNum">     850 </span><span class="lineNoCov">          0 :       if (margc == 2)</span>
<span class="lineNum">     851 </span>            :         {
<span class="lineNum">     852 </span><span class="lineNoCov">          0 :           if (STREQ (margv[1], &quot;--help&quot;))</span>
<span class="lineNum">     853 </span><span class="lineNoCov">          0 :             usage (EXIT_SUCCESS);</span>
<span class="lineNum">     854 </span>            : 
<span class="lineNum">     855 </span><span class="lineNoCov">          0 :           if (STREQ (margv[1], &quot;--version&quot;))</span>
<span class="lineNum">     856 </span>            :             {
<span class="lineNum">     857 </span><span class="lineNoCov">          0 :               version_etc (stdout, PROGRAM_NAME, PACKAGE_NAME, Version, AUTHORS,</span>
<span class="lineNum">     858 </span>            :                            (char *) NULL);
<span class="lineNum">     859 </span><span class="lineNoCov">          0 :               test_main_return (EXIT_SUCCESS);</span>
<span class="lineNum">     860 </span>            :             }
<span class="lineNum">     861 </span>            :         }
<span class="lineNum">     862 </span><span class="lineNoCov">          0 :       if (margc &lt; 2 || !STREQ (margv[margc - 1], &quot;]&quot;))</span>
<span class="lineNum">     863 </span><span class="lineNoCov">          0 :         test_syntax_error (_(&quot;missing %s&quot;), quote (&quot;]&quot;));</span>
<span class="lineNum">     864 </span>            : 
<span class="lineNum">     865 </span><span class="lineNoCov">          0 :       --margc;</span>
<span class="lineNum">     866 </span>            :     }
<span class="lineNum">     867 </span>            : 
<span class="lineNum">     868 </span><span class="lineNoCov">          0 :   argc = margc;</span>
<span class="lineNum">     869 </span><span class="lineNoCov">          0 :   pos = 1;</span>
<span class="lineNum">     870 </span>            : 
<span class="lineNum">     871 </span><span class="lineNoCov">          0 :   if (pos &gt;= argc)</span>
<span class="lineNum">     872 </span>            :     test_main_return (TEST_FALSE);
<span class="lineNum">     873 </span>            : 
<span class="lineNum">     874 </span><span class="lineNoCov">          0 :   value = posixtest (argc - 1);</span>
<span class="lineNum">     875 </span>            : 
<span class="lineNum">     876 </span><span class="lineNoCov">          0 :   if (pos != argc)</span>
<span class="lineNum">     877 </span><span class="lineNoCov">          0 :     test_syntax_error (_(&quot;extra argument %s&quot;), quote (argv[pos]));</span>
<span class="lineNum">     878 </span>            : 
<span class="lineNum">     879 </span><span class="lineNoCov">          0 :   test_main_return (value ? TEST_TRUE : TEST_FALSE);</span>
<span class="lineNum">     880 </span>            : }
</pre>
      </td>
    </tr>
  </table>
  <br>

  <table width="100%" border=0 cellspacing=0 cellpadding=0>
    <tr><td class="ruler"><img src="../glass.png" width=3 height=3 alt=""></td></tr>
    <tr><td class="versionInfo">Generated by: <a href="http://ltp.sourceforge.net/coverage/lcov.php" target="_parent">LCOV version 1.12</a></td></tr>
  </table>
  <br>

</body>
</html>
